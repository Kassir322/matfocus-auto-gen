# Руководство пользователя

Это простое руководство по установке, запуску и настройке.

## Установка

1. Установите Python 3.8+ и браузер (Chrome/Firefox/Edge).
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Проверьте, что экран 1920x1080+ и нет масштабирования >100% (рекомендация).

## Запуск

```bash
python main.py
```

При старте вы увидите инструкции и список горячих клавиш.

## Файлы настроек

- `data/settings.json` — параметры работы (создаётся автоматически)
- `data/coordinates.json` — координаты элементов UI (создаётся автоматически)
- `data/all_card_prompts.txt` — файл промптов

## Формат промптов

### Стандартный режим

```
Карточка 1 - Промпт 1: ТЕКСТ ПРОМПТА.
Карточка 1 - Промпт 2: ТЕКСТ ПРОМПТА.
Карточка 2 - Промпт 1: ТЕКСТ ПРОМПТА.
```

### Мультиформатный режим (без референсов и с референсами)

Каждая строка — одна часть пары (лицо/оборот):

```
Карточка <номер> лицо <Название> - Промпт <номер>: <текст>
Карточка <номер> оборот <Название> - Промпт <номер>: <текст>
```

- Для мультиформатного режима пары должны быть полными: и `лицо`, и `оборот`.
- Название карточки объединяет пары одной карточки.

Мини-пример:

```
Карточка 1 лицо Сова - Промпт 1: a cute owl, 4k
Карточка 1 оборот Сова - Промпт 1: back of an owl, 4k
Карточка 1 лицо Сова - Промпт 2: owl variant, studio
Карточка 1 оборот Сова - Промпт 2: owl back variant, studio
```

### Референсы (для режима с референсами)

В папке `data/images` должны быть файлы:

- `лицо_№_название.png` или `.jpg` (например, `лицо_1_Сова.png`)
- `оборот_№_название.png` или `.jpg` (например, `оборот_1_Сова.png`)

## Горячие клавиши

- Ctrl+Shift+P: показать/захватить координаты курсора
- Ctrl+0: меню настройки координат (обязательно заполните критичные)
- Ctrl+1: стартовая карточка
- Ctrl+2: генераций на карточку (только стандартный режим)
- Ctrl+3: время ожидания генерации
- Ctrl+4: вкл/выкл проверку изображений
- Ctrl+5: показать текущие настройки (с расчётами)
- Ctrl+6: конечная карточка (лимит диапазона)
- Ctrl+7: меню выбора режима генерации (1-3)
- Ctrl+8: время ожидания изображения (упрощённая проверка)
- Ctrl+Shift+V: быстрая настройка рабочего окна
- Ctrl+Shift+S: старт автоматизации
- Ctrl+Shift+Q: стоп автоматизации
- Esc: выход

## Режимы генерации

- **Стандартный (standard)**: многократные генерации на карточку.

  - Формат промптов: `Карточка X - Промпт Y: ТЕКСТ ПРОМПТА.`

- **Мультиформатный без референсов (multi_format)**: пары «лицо 4:3 + оборот 3:2». Требует координаты `FORMAT_SELECTOR`.

  - Формат промптов: `Карточка X лицо Название - Промпт Y: ТЕКСТ` и `Карточка X оборот Название - Промпт Y: ТЕКСТ`

- **Мультиформатный с референсами (multi_format_with_refs)**: пары «лицо 4:3 + оборот 3:2» с использованием референсов. ⚠️ Пока не реализован.
  - Требуются референсы в папке `data/images`:
    - `лицо_№_название.png` или `.jpg`
    - `оборот_№_название.png` или `.jpg`
  - Формат промптов такой же, как в мультиформатном без референсов

## Типичный сценарий

1. Настройте окно (Ctrl+Shift+V).
2. Настройте координаты (Ctrl+0). Для мультиформатных режимов обязательно `FORMAT_SELECTOR`.
3. Подготовьте файл промптов в новом формате (пары должны быть полными).
4. Выберите режим (Ctrl+7).
5. Проверьте настройки (Ctrl+5).
6. Запустите (Ctrl+Shift+S).

## Частые ошибки

- Не заданы координаты: откройте меню (Ctrl+0) и заполните.
- Пустые/неполные пары: проверьте файл промптов — для мультиформатных режимов обе строки пары обязательны.
- Нет окна браузера: нажмите Ctrl+Shift+S для создания и настройки окна.
- Слишком малое время ожидания: увеличьте `GENERATION_WAIT` или `IMAGE_WAIT_TIME`.
